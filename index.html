<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Master Quiz</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1e1e1e;
            color: #d4d4d4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* Top Bar for Score */
        .top-bar {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #2d2d2d;
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid #4CAF50;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 100;
        }

        .score-label { font-size: 0.9rem; color: #aaa; }
        .score-value { font-size: 1.5rem; font-weight: bold; color: #4CAF50; }

        .container {
            background-color: #252526;
            width: 90%;
            max-width: 800px;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid #3c3c3c;
            position: relative;
        }

        h1 { color: #569cd6; margin-top: 0; }
        .subtitle { color: #9cdcfe; margin-bottom: 25px; }

        .question-box {
            background: #333;
            padding: 20px;
            border-left: 6px solid #ce9178;
            margin-bottom: 25px;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        textarea {
            width: 100%;
            height: 120px;
            background: #1e1e1e;
            color: #d4d4d4;
            border: 2px solid #3c3c3c;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.1rem;
            resize: none;
            box-sizing: border-box;
            transition: border 0.3s;
        }

        textarea:focus { outline: none; border-color: #569cd6; }

        .btn-container {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: 0.2s;
        }

        #submit-btn { background-color: #0e639c; color: white; }
        #submit-btn:hover { background-color: #1177bb; }

        #next-btn { background-color: #4CAF50; color: white; display: none; }
        #next-btn:hover { background-color: #45a049; }

        /* Feedback Messages */
        .feedback-msg { 
            margin-top: 15px; 
            padding: 10px;
            border-radius: 5px;
            display: none; 
            font-weight: bold;
        }
        
        .success { color: #4CAF50; background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50;}
        .error { color: #f44336; background: rgba(244, 67, 54, 0.1); border: 1px solid #f44336; }

        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: #333;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .progress-fill {
            height: 100%;
            background: #569cd6;
            width: 0%;
            transition: width 0.3s;
            border-top-left-radius: 15px;
        }

    </style>
</head>
<body>

    <div class="top-bar">
        <span class="score-label">SCORE</span>
        <span class="score-value" id="score-display">0</span>
    </div>

    <div class="container">
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        
        <h1>HTML Code Challenge</h1>
        <div class="subtitle">Question <span id="q-num">1</span> of 10</div>

        <div class="question-box" id="question-text">
            Loading...
        </div>

        <textarea id="user-input" placeholder="Type your code here..."></textarea>
        
        <div id="feedback-area" class="feedback-msg"></div>

        <div class="btn-container">
            <button id="submit-btn" onclick="checkAnswer()">Run Code ‚ñ∂</button>
            <button id="next-btn" onclick="nextQuestion()">Next Question ‚ûú</button>
        </div>
    </div>

    <script>
        // --- QUIZ DATA ---
        const questions = [
            {
                q: "1. Create a large Heading (h1) with the text 'Welcome'.",
                checkString: "<h1>welcome</h1>",
                renderCode: "<h1>Welcome</h1>"
            },
            {
                q: "2. Create a paragraph (p) that says 'I love coding'.",
                checkString: "<p>i love coding</p>",
                renderCode: "<p>I love coding</p>"
            },
            {
                q: "3. Create a clickable button that says 'Submit'.",
                checkString: "<button>submit</button>",
                renderCode: "<button style='padding:15px 30px; background:blue; color:white; border:none; border-radius:5px;'>Submit</button>"
            },
            {
                q: "4. Create a text input field.",
                checkString: "<input type=\"text\">",
                renderCode: "<label>Username: </label><input type='text' placeholder='Enter name'>"
            },
            {
                q: "5. Make the word 'Bold' bold using the <b> tag.",
                checkString: "<b>bold</b>",
                renderCode: "This is normal text, this is <b>Bold</b> text."
            },
            {
                q: "6. Create a link to 'google.com' with text 'Search'.",
                checkString: "<a href=\"google.com\">search</a>",
                renderCode: "<a href='https://google.com' target='_blank'>Search</a>"
            },
            {
                q: "7. Create a Heading 2 (h2) with text 'Subheading'.",
                checkString: "<h2>subheading</h2>",
                renderCode: "<h2>Subheading</h2>"
            },
            // --- IMAGE QUESTION ---
            {
                q: "8. Display the local image named 'image.png'.",
                checkString: "<img src=\"image.png\">",
                // We leave 'image.png' here, but the JS function below will fix the link!
                renderCode: "<h2>Look!</h2><img src='image.png' alt='Image not found' style='max-width:300px; border: 5px solid gold;'>"
            },
            {
                q: "9. Create a Horizontal Rule (line).",
                checkString: "<hr>",
                renderCode: "<h3>Section 1</h3><hr><h3>Section 2</h3>"
            },
            {
                q: "10. Create an italic text 'The End' using <i> tag.",
                checkString: "<i>the end</i>",
                renderCode: "<h1><i>The End</i></h1><p>Great job finishing the quiz!</p>"
            }
        ];

        let currentIdx = 0;
        let score = 0;
        
        // DOM Elements
        const qText = document.getElementById('question-text');
        const qNum = document.getElementById('q-num');
        const userInput = document.getElementById('user-input');
        const feedbackArea = document.getElementById('feedback-area');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress');
        const scoreDisplay = document.getElementById('score-display');

        function loadQuestion() {
            if (currentIdx >= questions.length) {
                document.querySelector('.container').innerHTML = `
                    <h1 style="text-align:center; color:#4CAF50;">üéâ Quiz Completed!</h1>
                    <p style="text-align:center; font-size:1.5rem; color:#d4d4d4;">Final Score: <span style="color:#4CAF50; font-weight:bold;">${score}</span> / 100</p>
                    <button onclick="location.reload()" style="display:block; margin:20px auto; background:#569cd6; color:white; padding:15px 30px; border:none; border-radius:5px; cursor:pointer; font-size:1.2rem;">Play Again</button>
                `;
                return;
            }

            qText.innerText = questions[currentIdx].q;
            qNum.innerText = currentIdx + 1;
            userInput.value = "";
            userInput.disabled = false;
            userInput.style.borderColor = "#3c3c3c";
            feedbackArea.style.display = "none";
            feedbackArea.className = "feedback-msg";
            submitBtn.style.display = "block";
            nextBtn.style.display = "none";
            progressBar.style.width = ((currentIdx) / questions.length * 100) + "%";
            userInput.focus();
        }

        function checkAnswer() {
            const userVal = userInput.value.trim().toLowerCase().replace(/\s+/g, ' '); 
            const correctVal = questions[currentIdx].checkString;

            userInput.disabled = true;
            submitBtn.style.display = "none";
            nextBtn.style.display = "block";

            if (userVal.includes(correctVal)) {
                score += 10;
                scoreDisplay.innerText = score;
                userInput.style.borderColor = "#4CAF50"; 
                feedbackArea.innerHTML = "‚úÖ Correct! Opening result in new tab...";
                feedbackArea.classList.add("success");
                feedbackArea.style.display = "block";
                
                openResultTab(questions[currentIdx].renderCode);
            } else {
                userInput.style.borderColor = "#f44336"; 
                feedbackArea.innerHTML = `‚ùå Wrong. The correct code was: <br><code style='color:#fff'>${escapeHtml(questions[currentIdx].checkString)}</code>`;
                feedbackArea.classList.add("error");
                feedbackArea.style.display = "block";
            }
        }

        function escapeHtml(text) {
            return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
        }

        function openResultTab(htmlContent) {
            // --- THE FIX IS HERE ---
            // 1. Calculate the FULL URL of the image based on where the user is currently located.
            // This works for Localhost AND GitHub Pages automatically.
            const fullImageURL = new URL('image.png', window.location.href).href;

            // 2. Replace the simple 'image.png' in the code with the FULL URL
            const fixedContent = htmlContent.replace("src='image.png'", `src='${fullImageURL}'`);

            const fullPage = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>‚úÖ Result Preview</title>
                    <style>
                        body { font-family: sans-serif; text-align: center; padding: 40px; background: #f4f4f9; }
                        .card { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: inline-block; }
                        h2 { color: #4CAF50; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
                        .preview-area { margin-top: 20px; padding: 20px; border: 2px dashed #bbb; background: #fafafa; }
                    </style>
                </head>
                <body>
                    <div class="card">
                        <h2>Correct! Result Preview:</h2>
                        <div class="preview-area">
                            ${fixedContent} 
                        </div>
                        <p style="margin-top:20px; color:#888;">Close this tab to continue the quiz.</p>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([fullPage], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
        }

        function nextQuestion() {
            currentIdx++;
            loadQuestion();
        }

        loadQuestion();
    </script>

</body>

</html>
